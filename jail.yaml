- builder:
    name: setup-jail
    builders:
      - shell: sh FreeBSD-ci/scripts/jail/setup.sh

- builder:
    name: execute-in-jail
    builders:
      - shell: sh FreeBSD-ci/scripts/jail/execute.sh

- publisher:
    name: clean-jail
    publishers:
      - post-tasks:
          - task:
            script: sh FreeBSD-ci/scripts/jail/clean.sh

- publisher:
    name: scan-clang-warnings
    publishers:
      - warnings:
          console-log-parsers:
            - Clang (LLVM based)

- publisher:
    name: scan-gcc4-warnings
    publishers:
      - warnings:
          console-log-parsers:
            - GNU C Compiler 4 (gcc)

- publisher:
    name: publish-junit-results
    publishers:
      - junit:
          results: test-report.xml

- publisher:
    name: mail-notify
    publishers:
      - email-ext:
          disable-publisher: true
          recipients: lwhsu.jenkins@lwhsu.org
          subject: "$PROJECT_NAME - Build #$BUILD_NUMBER - $BUILD_STATUS"
          body: |
            $PROJECT_NAME - Build #$BUILD_NUMBER - $BUILD_STATUS:
            
            Build information: ${BUILD_URL}
            Full change log: ${BUILD_URL}changes
            Full build log: ${BUILD_URL}console
            
            Change summaries:
            
            ${CHANGES, format="%r by %a:\\n%m\\n"}
            
            The end of the build log:
            
            ${BUILD_LOG}
          failure: true
          unstable: false
          fixed: false
          send-to:
            - culprits
            - recipients
      - email-ext:
          disable-publisher: true
          recipients: lwhsu.jenkins@lwhsu.org
          subject: "$PROJECT_NAME - Build #$BUILD_NUMBER - $BUILD_STATUS"
          body: |
            $PROJECT_NAME - Build #$BUILD_NUMBER - $BUILD_STATUS:
            
            Build information: ${BUILD_URL}
            Full change log: ${BUILD_URL}changes
            Full build log: ${BUILD_URL}console
            
            Change summaries:
            
            ${CHANGES, format="%r by %a:\\n%m\\n"}
            
            The failed test cases:
            
            ${FAILED_TESTS, showStack="false", showMessage="false"}
          failure: false
          unstable: true
          fixed: false
          send-to:
            - culprits
            - recipients
      - email-ext:
          disable-publisher: true
          recipients: lwhsu.jenkins@lwhsu.org
          subject: "$PROJECT_NAME - Build #$BUILD_NUMBER - $BUILD_STATUS"
          body: |
            $PROJECT_NAME - Build #$BUILD_NUMBER - $BUILD_STATUS:
            
            Build information: ${BUILD_URL}
            Full change log: ${BUILD_URL}changes
            Full build log: ${BUILD_URL}console
            
            Change summaries:
            
            ${CHANGES, format="%r by %a:\\n%m\\n"}
          failure: false
          unstable: false
          fixed: true
          send-to:
            - culprits
            - recipients
