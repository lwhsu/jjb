- defaults:
    name: global
    project-type: freestyle
    concurrent: false
    disabled: false
    block-downstream: false
    block-upstream: false
    logrotate:
      daysToKeep: -1
      numToKeep: 200
      artifactDaysToKeep: -1
      artifactNumToKeep: -1

- scm:
    name: freebsd-src-head
    scm:
      - svn:
          repos:
            - url: https://svn.freebsd.org/base/head/
              basedir: src
            - url: https://github.com/freebsd/freebsd-ci
              basedir: freebsd-ci
          workspaceupdater: emulateclean
          viewvc-url: https://svnweb.freebsd.org/base/

- builder:
    name: setup-jail
    builders:
      - shell: sh freebsd-ci/scripts/jail/setup.sh

- builder:
    name: execute-in-jail
    builders:
      - shell: sh freebsd-ci/scripts/jail/execute.sh

- publisher:
    name: clean-jail
    publishers:
      - post-tasks:
          - task:
            script: sh freebsd-ci/scripts/jail/clean.sh

- job:
    defaults: global
    name: test-jjb
    node: jailer
    scm:
      - freebsd-src-head
    triggers:
      - pollscm: H H/2 * * *
    builders:
      - setup-jail
      - execute-in-jail
    publishers:
      - clean-jail
